<html>
  <head>
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/common.css" />
    <script src="../js/jq.js"></script>
    <script src="../js/random.js"></script>
    <style>
      #test-page{width:100%;height:100%;z-index:255;display:none;background-color:white;}
      .circle{position:absolute;border:1px solid black;border-radius:50%;width:20px;height:20px;}
    </style>
  </head>
  <body>
    <h1>反应力小测试</h1>
    <div id="point"></div>
    <div id="introduce">点击开始按钮后，页面中会出现若干个圆点，然后迅速消失，测试时长为20s，结束后统计在规定时间内点击到的圆点数量</div>
    <button>开始！</button>
    <div class="back" onclick="history.back()">←</div>
    <div id="test-page" class="center"></div>
    <script>let vConsole = new VConsole();</script>
    <script>
      const PAGE = jq("#test-page");
      const BUTTON = jq("button");
      BUTTON.bind("click",function(){
        PAGE.css({display:'block'});
        let count = 0;
        document.onclick = function(e){
          let t = e.target;
          if(t.className === "circle"){
            let j = jq(t);
            let w = j.w;
            j.animation(function(t){
              if(j.w < 1.5*w){
                j.resize([j.w+5,j.w+5]);
                return true;
              }else{
                j.remove();
                return false;
              }
            })
            count++;
          }
        }
        let timer = setInterval(function(){
          let num = random.randInt(1,3);
          for(let i=0;i<num;i++){
            let p = jq.create("div",{class:"circle"});
            let r1 = random.randInt(20,100);
            p.resize([r1,r1]);
            p.move([random.randInt(0,jq.body.w-p.w),random.randInt(0,jq.body.h-p.h)]);
            let r = random.randInt(0,255),
                g = random.randInt(0,255),
                b = random.randInt(0,255);
            p.css({backgroundColor:`rgb(${r},${g},${b})`});
            PAGE.append(p);
            setTimeout(function(){p.remove()},700)
          }          
        },1000)
        setTimeout(function(){
          clearInterval(timer);
          PAGE.css({display:'none'});
          jq("#point").set({inner:`您的分数：${count}`})
        },20000);
      });
      
    </script>
  </body>
</html>
